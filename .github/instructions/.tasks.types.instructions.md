---
applyTo: "*.tasks.types.ps1"
---

# Task File Types Instructions

## Purpose

`.tasks.types.ps1` files define PowerShell classes or enums that a matching `.tasks.ps1` file requires. The bootstrapper automatically loads the types file (if present) immediately before dot-sourcing the task script, so any types declared here are available without extra work.

## Authoring guidelines

- Pair the types file 1:1 with a task script: `modules/<name>.tasks.ps1` can ship `modules/<name>.tasks.types.ps1`. Avoid cross-linking types between modules; if multiple task files need the same type, promote it to a reusable module instead.
- Keep the surface minimal. Only introduce a custom type when it materially simplifies downstream code. Prefer native PowerShell constructs unless a type removes duplication or clarifies intent significantly.
- Use comment-based help above each class to document intent, invariant behaviour, and simple examples. This keeps hover help informative without forcing contributors to dig into implementation details.
- Stick to lightweight dotnet types (classes/enums) without external dependencies. The bootstrapper merely dot-sources this file, so any heavy initialization or module imports could introduce side effects for every task invocation.
- Honor PowerShell naming guidance: PascalCase for type names, avoid verb prefixes, and default to ASCII characters unless a type interacts with Unicode-specific scenarios.
- Treat types as implementation details of the accompanying task file. If callers outside the task need the same abstraction, migrate it to a proper module instead of exposing it indirectly through the tasks file.

## Testing

- When a type encapsulates non-trivial logic, back it with targeted Pester tests. Helper functions can mock or instantiate the type directly because the bootstrapper loads it prior to task execution.
